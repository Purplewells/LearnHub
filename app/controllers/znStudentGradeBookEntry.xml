<?xml version="1.0" encoding="utf-8"?>
<dataController name="znStudentGradeBookEntry" label="znStudentGradeBookEntry" conflictDetection="overwriteChanges" plugIn="zLearnHub.Data.AnnotationPlugIn" handler="zLearnHub.Rules.znStudentGradeBookEntryBusinessRules" xmlns="urn:schemas-codeontime-com:data-aquarium">
  <commands>
    <command id="command1" type="Text">
      <text><![CDATA[
select
	"StudentGradeBookEntry"."StudentGradeBookEntryID" "StudentGradeBookEntryID"
	,"StudentGradeBookEntry"."LetterGrade" "LetterGrade"
	,"StudentGradeBookEntry"."NumericGradeEarned" "NumericGradeEarned"
	,"StudentGradeBookEntry"."Weight" "Weight"
	,"StudentGradeBookEntry"."StudentCourseSectionID" "StudentCourseSectionID"
	,"StudentCourseSection"."CreatedBy" "StudentCourseSectionCreatedBy"
	,"StudentGradeBookEntry"."GradeBookEntryID" "GradeBookEntryID"
	,"GradeBookEntry"."GradeBookTitle" "GradeBookTitle"
	,"StudentGradeBookEntry"."GradeBookEntryTypeID" "GradeBookEntryTypeID"
	,"GradeBookEntryType"."GradeBookEntryType" "GBEntryType"
	,"GradeBookEntryType"."Code" "ASTY"
	,"StudentGradeBookEntry"."GradingPeriodID" "GradingPeriodID"
	,"GradingPeriod"."GradingPeriod" "GradingPeriod"
	,"StudentGradeBookEntry"."CompetencyLevelDescriptorID" "CompetencyLevelDescriptorID"
	,"StudentGradeBookEntry"."SubmittedDate" "SubmittedDate"
	,"StudentGradeBookEntry"."PerformanceBaseConversionID" "PerformanceBaseConversionID"
	,"PerformanceBaseConversion"."PerformanceBaseConversion" "PerformanceBaseConversion"
	,"PerformanceBaseConversion"."MinScore" "MinScore"
	,"PerformanceBaseConversion"."MaxScore" "MaxScore"
	,"PerformanceBaseConversion"."GradeName" "NG"
	,"PerformanceBaseConversion"."Grade" "LG"
	,"PerformanceBaseConversion"."Passing" "Passing"
	,"PerformanceBaseConversion"."Description" "PerformanceBaseConversionDescription"
	,"PerformanceBaseConversion"."GradeRank" "GradeRank"
	,"StudentGradeBookEntry"."CreatedDate" "CreatedDate"
	,"StudentGradeBookEntry"."ModifiedDate" "ModifiedDate"
	,"StudentGradeBookEntry"."CreatedBy" "CreatedBy"
	,"StudentGradeBookEntry"."ModifiedBy" "ModifiedBy"
	,"StudentGradeBookEntry"."UserID" "UserID"
	,"StudentGradeBookEntry"."extMaxScore" "extMaxScore"
	,"StudentGradeBookEntry"."extIsActiveSession" "extIsActiveSession"
	,"StudentGradeBookEntry"."extIsCSY" "ExtIsCsy"
	,"StudentGradeBookEntry"."extActiveCourseSection" "ExtActiveCourseSection"
	,"StudentGradeBookEntry"."extPBSG" "ExtPBSG"
	,"StudentGradeBookEntry"."extCalendarSessionID" "ExtCalendarSessionID"
	,"StudentGradeBookEntry"."RefSchoolStreamID" "RefSchoolStreamID"
	,"RefSchoolStream"."Description" "Stream"
	,"StudentGradeBookEntry"."extIsPassing" "ExtIsPassing"
	,"StudentGradeBookEntry"."extPWS" "ExtPWS"
	,"StudentGradeBookEntry"."extOWS" "ExtOWS"
	,"RefEntryGradeLevel"."Description" "GradeLevel"
	,"RefEntryGradeLevel"."SortOrder" "GLSO"
	,"CalendarSession"."SessionName" "Session"
	,"CalendarSession"."IsActive" "SessionIsActive"
	,"OrganizationCalendar"."CalendarYear" "calYear"
	,"OrganizationCalendar"."CurrentSchoolYear" "CSY"
	,"Person"."IdentificationCode" "UPN"
	,"Person"."FirstName" "Firstname"
	,"Person"."LastName" "Lastname"
	,"Course"."CourseTitle" "Course"
	,"StudentGradeBookEntry"."extSGID" "extSGID"
	,"StudentGradeBookEntry"."extSCID" "extSCID"
from "dbo"."StudentGradeBookEntry" "StudentGradeBookEntry"
	left join "dbo"."StudentSectionAssociation" "StudentCourseSection" on "StudentGradeBookEntry"."StudentCourseSectionID" = "StudentCourseSection"."StudentCourseSectionID"
	left join "dbo"."StudentSchoolAssociation" "StudentEnrollment" on "StudentCourseSection"."StudentEnrollmentID" = "StudentEnrollment"."StudentEnrollmentID"
	left join "dbo"."zlkpGradeLevel" "RefEntryGradeLevel" on "StudentEnrollment"."RefEntryGradeLevelId" = "RefEntryGradeLevel"."RefGradeLevelId"
	left join "dbo"."Session" "CalendarSession" on "StudentEnrollment"."CalendarSessionID" = "CalendarSession"."CalendarSessionID"
	left join "dbo"."Calendar" "OrganizationCalendar" on "CalendarSession"."OrganizationCalendarID" = "OrganizationCalendar"."OrganizationCalendarId"
	left join "dbo"."OrganizationPersonRole" "OrganizationPersonRole" on "StudentEnrollment"."OrganizationPersonRoleID" = "OrganizationPersonRole"."OrganizationPersonRoleID"
	left join "dbo"."Person" "Person" on "OrganizationPersonRole"."PersonID" = "Person"."PersonID"
	left join "dbo"."CourseSection" "CourseSection" on "StudentCourseSection"."CourseSectionID" = "CourseSection"."CourseSectionID"
	left join "dbo"."Course" "Course" on "CourseSection"."CourseID" = "Course"."CourseID"
	left join "dbo"."GradeBookEntry" "GradeBookEntry" on "StudentGradeBookEntry"."GradeBookEntryID" = "GradeBookEntry"."GradeBookEntryID"
	left join "dbo"."zlkp_GradeBookEntryType" "GradeBookEntryType" on "StudentGradeBookEntry"."GradeBookEntryTypeID" = "GradeBookEntryType"."GradeBookEntryTypeID"
	left join "dbo"."GradingPeriod" "GradingPeriod" on "StudentGradeBookEntry"."GradingPeriodID" = "GradingPeriod"."GradingPeriodID"
	left join "dbo"."zlkpPerformanceBaseConversion" "PerformanceBaseConversion" on "StudentGradeBookEntry"."PerformanceBaseConversionID" = "PerformanceBaseConversion"."PerformanceBaseConversionID"
	left join "dbo"."zlkpSchoolStream" "RefSchoolStream" on "StudentGradeBookEntry"."RefSchoolStreamID" = "RefSchoolStream"."RefSchoolStreamID"
]]></text>
    </command>
    <command id="StudentGradeBookEntryIDIdentityCommand" type="Text" event="Inserted">
      <text><![CDATA[select @@identity]]></text>
      <output>
        <fieldOutput fieldName="StudentGradeBookEntryID" />
      </output>
    </command>
  </commands>
  <fields>
    <field name="StudentGradeBookEntryID" type="Int32" allowNulls="false" isPrimaryKey="true" label="Student Grade Book Entry ID" readOnly="true" />
    <field name="LetterGrade" type="String" label="Letter Grade" length="5" showInSummary="true" />
    <field name="NumericGradeEarned" type="Decimal" label="Score" showInSummary="true" causesCalculate="true" />
    <field name="Weight" type="Decimal" label="% Wt" showInSummary="true" causesCalculate="true" />
    <field name="StudentCourseSectionID" type="Int32" label="Student Course Section ID" showInSummary="true">
      <items style="Lookup" dataController="StudentSectionAssociation" newDataView="createForm1" dataValueField="StudentCourseSectionID" dataTextField="StudentEnrollmentCreatedBy" copy="GradeLevel=GL, GLSO=GLSO, UPN=UPN, Firstname=Firstname, Lastname=Lastname, Course=Course" />
    </field>
    <field name="StudentCourseSectionCreatedBy" type="String" readOnly="true" label="Student Course Section Created By" length="50" />
    <field name="GradeBookEntryID" type="Int32" label="Grade Book Entry ID" showInSummary="true">
      <items style="Lookup" dataController="GradeBookEntries" newDataView="createForm1" dataValueField="GradeBookEntryID" dataTextField="GradeBook" />
    </field>
    <field name="GradeBookTitle" type="String" readOnly="true" label="GB Title" length="20" />
    <field name="GradeBookEntryTypeID" type="Int32" label="Grade Book Entry Type ID">
      <items style="Lookup" dataController="AssessmentType" newDataView="createForm1" dataValueField="GradeBookEntryTypeID" dataTextField="GradeBookEntryType" copy="ASTY=Code" />
    </field>
    <field name="GBEntryType" type="String" readOnly="true" label="CASTY" length="100" />
    <field name="ASTY" type="String" readOnly="true" label="ASTY" length="50" />
    <field name="GradingPeriodID" type="Int32" label="Grading Period ID">
      <items style="Lookup" dataController="GradingPeriod" newDataView="createForm1" dataValueField="GradingPeriodID" dataTextField="GradingPeriod" />
    </field>
    <field name="GradingPeriod" type="String" readOnly="true" label="GP" length="25" />
    <field name="CompetencyLevelDescriptorID" type="Int32" label="Competency Level Descriptor ID" />
    <field name="SubmittedDate" type="DateTime" label="Assesment Date" />
    <field name="PerformanceBaseConversionID" type="Int32" label="Performance Base Conversion ID">
      <items style="Lookup" dataController="PerformanceBaseConversion" newDataView="createForm1" dataValueField="PerformanceBaseConversionID" dataTextField="PerformanceBaseConversion" copy="MinScore=MinScore, MaxScore=MaxScore, NG=GradeName, LG=Grade, Passing=Passing, PerformanceBaseConversionDescription=Description, GradeRank=GradeRank" />
    </field>
    <field name="PerformanceBaseConversion" type="String" readOnly="true" label="Performance Base Conversion" length="30" />
    <field name="MinScore" type="Decimal" readOnly="true" label="Min Score" />
    <field name="MaxScore" type="Decimal" readOnly="true" label="Max Score" />
    <field name="NG" type="String" readOnly="true" label="NG" length="20" />
    <field name="LG" type="String" readOnly="true" label="LG" length="20" />
    <field name="Passing" type="Boolean" readOnly="true" label="PSN" />
    <field name="PerformanceBaseConversionDescription" type="String" readOnly="true" label="Performance Base Conversion Description" length="100" />
    <field name="GradeRank" type="Int32" readOnly="true" label="Grade Rank" />
    <field name="CreatedDate" type="DateTime" dataFormatString="g" label="Created Date" />
    <field name="ModifiedDate" type="DateTime" dataFormatString="g" label="Modified Date" />
    <field name="CreatedBy" type="String" label="Created By" length="50" />
    <field name="ModifiedBy" type="String" label="Modified By" length="50" />
    <field name="UserID" type="Guid" label="UserID" />
    <field name="extMaxScore" type="Decimal" label="MPP" causesCalculate="true" />
    <field name="extIsActiveSession" type="Int32" label="extIsActiveSession" />
    <field name="ExtIsCsy" type="Int32" label="CSY" />
    <field name="ExtActiveCourseSection" type="Boolean" label="ACS" />
    <field name="ExtPBSG" type="Decimal" label="extPBSG" />
    <field name="ExtCalendarSessionID" type="Int32" label="ext Calendar Session ID" />
    <field name="RefSchoolStreamID" type="Int32" label="Ref School Stream ID">
      <items style="Lookup" dataController="SchoolStream" newDataView="createForm1" dataValueField="RefSchoolStreamID" dataTextField="Description" />
    </field>
    <field name="Stream" type="String" readOnly="true" label="STM" length="8" />
    <field name="ExtIsPassing" type="Boolean" label="extIsPassing" />
    <field name="ExtPWS" type="Decimal" label="extPWS" />
    <field name="ExtOWS" type="Decimal" label="extOWS" />
    <field name="CWS" type="Decimal" readOnly="true" label="CWS" computed="true">
      <formula>SELECT SUM((StudentGradeBookEntry.NumericGradeEarned / StudentGradeBookEntry.extMaxScore) * StudentGradeBookEntry.Weight)
FROM StudentGradeBookEntry
WHERE StudentGradeBookEntry.StudentCourseSectionID = StudentCourseSection.StudentCourseSectionID</formula>
    </field>
    <field name="GradeLevel" type="String" readOnly="true" label="GL" length="100" />
    <field name="GLSO" type="Decimal" readOnly="true" label="GLSO" />
    <field name="Session" type="String" readOnly="true" label="Session" length="50" />
    <field name="SessionIsActive" type="Boolean" readOnly="true" label="SSIA" />
    <field name="calYear" type="Int32" readOnly="true" label="Cal Year" />
    <field name="CSY" type="Boolean" readOnly="true" label="CSY" />
    <field name="UPN" type="String" readOnly="true" label="UPN" length="10" />
    <field name="Firstname" type="String" readOnly="true" label="Firstname" length="35" />
    <field name="Lastname" type="String" readOnly="true" label="Lastname" length="35" />
    <field name="Course" type="String" readOnly="true" label="Course" length="60" />
    <field name="SGID" type="Int32" readOnly="true" label="SGID" computed="true">
      <formula>StudentGradeBookEntry.StudentGradeBookEntryID</formula>
    </field>
    <field name="SCID" type="Int32" readOnly="true" label="SCID" computed="true">
      <formula>StudentCourseSection.StudentCourseSectionID</formula>
    </field>
    <field name="extSGID" type="Int32" label="extSGID" />
    <field name="extSCID" type="Int32" label="extSCID" />
    <field name="Fullname" type="String" readOnly="true" label="Fullname" computed="true">
      <formula>UPPER(Person.FirstName + ', ' + Person.LastName)</formula>
    </field>
  </fields>
  <views>
    <view id="grid1" type="Grid" commandId="command1" label="Active Scores" groupExpression="GLSO, Course, GradeLevel, Stream, Session" filter="SessionIsActive = 1">
      <headerText>$DefaultGridViewDescription</headerText>
      <dataFields>
        <dataField fieldName="Firstname" columns="18" />
        <dataField fieldName="Lastname" columns="18" />
        <dataField fieldName="UPN" columns="10" />
        <dataField fieldName="GradeLevel" columns="5" tag="pivot3-col1&#xD;&#xA;pivot4-col1" />
        <dataField fieldName="RefSchoolStreamID" aliasFieldName="Stream" columns="5" />
        <dataField fieldName="Course" columns="20" tag="pivot1-row1-pie&#xD;&#xA;pivot1-title:&quot;What is the outlook of assessment space&quot;&#xD;&#xA;&#xD;&#xA;pivot2-row1-column&#xD;&#xA;pivot2-title:&quot;What is the avergae score by subject&quot;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;pivot3-row1-columnstacked&#xD;&#xA;pivot3-title:&quot;What is the avergae score by subject and grade level&quot;&#xD;&#xA;&#xD;&#xA;pivot4-row1-columnstacked-top10-sortbyvalue&#xD;&#xA;pivot4-title:&quot;What is the top 10 scores by subject and grade level&quot;" />
        <dataField fieldName="GradeBookEntryID" aliasFieldName="GradeBookTitle" columns="15" tag="pivot9-row1-columnstacked-other-sortbyvalue&#xD;&#xA;pivot9-title:&quot;What is the distribution avg score by gradebook&quot;&#xD;&#xA;pivot9-haxistitle:&quot;Gradebook&quot;&#xD;&#xA;pivot9-vaxistitle:&quot;Calculate Score&quot;" />
        <dataField fieldName="LetterGrade" columns="5" hidden="true" />
        <dataField fieldName="NumericGradeEarned" columns="5" tag="pivot2-val1-avg&#xD;&#xA;pivot7-val1-avg" />
        <dataField fieldName="extMaxScore" columns="5" />
        <dataField fieldName="Weight" columns="5" />
        <dataField fieldName="ExtPBSG" columns="7">
          <headerText>%PBSG</headerText>
        </dataField>
        <dataField fieldName="ExtPWS" columns="5" tag="pivot9-val1-avg">
          <headerText>PWS</headerText>
        </dataField>
        <dataField fieldName="CWS" columns="5" />
        <dataField fieldName="ExtOWS" columns="5" tag="pivot8-val1-avg">
          <headerText>OWS</headerText>
        </dataField>
        <dataField fieldName="StudentCourseSectionID" aliasFieldName="StudentCourseSectionCreatedBy" hidden="true" />
        <dataField fieldName="GradeBookEntryTypeID" aliasFieldName="GBEntryType" hidden="true" tag="pivot8-row1-column-top10-other-sortbyvalue&#xD;&#xA;pivot8-title:&quot;What is the distribution score by assessment score&quot;&#xD;&#xA;pivot8-haxistitle:&quot;Assessment Type&quot;&#xD;&#xA;pivot8-vaxistitle:&quot;Calculate Score&quot;&#xD;&#xA;&#xD;&#xA;pivot9-col1" />
        <dataField fieldName="SubmittedDate" columns="10" hidden="true" />
        <dataField fieldName="PerformanceBaseConversionID" aliasFieldName="PerformanceBaseConversion" hidden="true" tag="pivot5-row1-donut-top10-other-sortbyvalue&#xD;&#xA;pivot5-title:&quot;What is the distribution of performance outcomes&quot;" />
        <dataField fieldName="PerformanceBaseConversionDescription" hidden="true" />
        <dataField fieldName="MinScore" columns="15" hidden="true" />
        <dataField fieldName="MaxScore" columns="15" hidden="true" />
        <dataField fieldName="NG" columns="20" hidden="true" />
        <dataField fieldName="Passing" columns="5" tag="pivot6-row1-donut-top10-other-sortbyvalue&#xD;&#xA;pivot6-title:&quot;What is the distribution of performance outcomes (Pass/Fail)&quot;" />
        <dataField fieldName="ExtIsPassing" hidden="true" />
        <dataField fieldName="LG" columns="5" />
        <dataField fieldName="GradeRank" columns="15" hidden="true" />
        <dataField fieldName="CreatedDate" columns="20" hidden="true" />
        <dataField fieldName="ModifiedDate" columns="20" hidden="true" />
        <dataField fieldName="CreatedBy" columns="50" hidden="true" />
        <dataField fieldName="ModifiedBy" columns="50" hidden="true" />
        <dataField fieldName="UserID" columns="15" hidden="true" />
        <dataField fieldName="extIsActiveSession" columns="15" hidden="true" />
        <dataField fieldName="ASTY" columns="5" />
        <dataField fieldName="ExtIsCsy" columns="15" hidden="true" />
        <dataField fieldName="ExtActiveCourseSection" hidden="true" />
        <dataField fieldName="ExtCalendarSessionID" columns="15" hidden="true" />
        <dataField fieldName="GLSO" columns="15" hidden="true" />
        <dataField fieldName="GradingPeriodID" aliasFieldName="GradingPeriod" columns="18" tag="pivot7-row1-column-top10-other-sortbyvalue&#xD;&#xA;pivot7-title:&quot;What is the distribution of average score&quot;" />
        <dataField fieldName="SessionIsActive" />
        <dataField fieldName="Session" columns="50" hidden="true" />
        <dataField fieldName="calYear" columns="15" hidden="true" />
        <dataField fieldName="CSY" hidden="true" />
        <dataField fieldName="SGID" columns="8" textMode="Static" />
        <dataField fieldName="SCID" columns="8" textMode="Static" />
        <dataField fieldName="extSGID" columns="15" hidden="true" />
        <dataField fieldName="extSCID" columns="15" hidden="true" />
        <dataField fieldName="Fullname" />
      </dataFields>
    </view>
    <view id="grid1_mobi" type="Grid" commandId="command1" label="Mobile Active Scores" groupExpression=" Course, GradeLevel, Stream, Session" sortExpression="GLSO ASC" filter="SessionIsActive = 1">
      <headerText>$DefaultGridViewDescription</headerText>
      <dataFields>
        <dataField fieldName="Firstname" columns="18" />
        <dataField fieldName="Lastname" columns="18" />
        <dataField fieldName="UPN" columns="10" />
        <dataField fieldName="GradeLevel" columns="5" />
        <dataField fieldName="RefSchoolStreamID" aliasFieldName="Stream" columns="5" />
        <dataField fieldName="Course" columns="20" />
        <dataField fieldName="GradeBookEntryID" aliasFieldName="GradeBookTitle" columns="15" />
        <dataField fieldName="LetterGrade" columns="5" hidden="true" />
        <dataField fieldName="NumericGradeEarned" columns="5" />
        <dataField fieldName="extMaxScore" columns="5" />
        <dataField fieldName="Weight" columns="5" />
        <dataField fieldName="ExtPBSG" columns="5" hidden="true">
          <headerText>%PBSG</headerText>
        </dataField>
        <dataField fieldName="ExtPWS" columns="5">
          <headerText>PWS</headerText>
        </dataField>
        <dataField fieldName="ExtOWS" columns="5" hidden="true">
          <headerText>OWS</headerText>
        </dataField>
        <dataField fieldName="CWS" columns="5" />
        <dataField fieldName="StudentCourseSectionID" aliasFieldName="StudentCourseSectionCreatedBy" hidden="true" />
        <dataField fieldName="GradeBookEntryTypeID" aliasFieldName="GBEntryType" hidden="true" />
        <dataField fieldName="SubmittedDate" columns="10" hidden="true" />
        <dataField fieldName="PerformanceBaseConversionID" aliasFieldName="PerformanceBaseConversion" hidden="true" />
        <dataField fieldName="PerformanceBaseConversionDescription" hidden="true" />
        <dataField fieldName="MinScore" columns="15" hidden="true" />
        <dataField fieldName="MaxScore" columns="15" hidden="true" />
        <dataField fieldName="NG" columns="20" hidden="true" />
        <dataField fieldName="Passing" columns="5" hidden="true" />
        <dataField fieldName="ExtIsPassing" hidden="true" />
        <dataField fieldName="LG" columns="5" hidden="true" />
        <dataField fieldName="GradeRank" columns="15" hidden="true" />
        <dataField fieldName="CreatedDate" columns="20" hidden="true" />
        <dataField fieldName="ModifiedDate" columns="20" hidden="true" />
        <dataField fieldName="CreatedBy" columns="50" hidden="true" />
        <dataField fieldName="ModifiedBy" columns="50" hidden="true" />
        <dataField fieldName="UserID" columns="15" hidden="true" />
        <dataField fieldName="extIsActiveSession" columns="15" hidden="true" />
        <dataField fieldName="ASTY" columns="5" />
        <dataField fieldName="ExtIsCsy" columns="15" hidden="true" />
        <dataField fieldName="ExtActiveCourseSection" hidden="true" />
        <dataField fieldName="ExtCalendarSessionID" columns="15" hidden="true" />
        <dataField fieldName="GLSO" columns="15" hidden="true" />
        <dataField fieldName="GradingPeriodID" aliasFieldName="GradingPeriod" columns="12" />
        <dataField fieldName="SessionIsActive" hidden="true" />
        <dataField fieldName="Session" columns="50" hidden="true" />
        <dataField fieldName="calYear" columns="15" hidden="true" />
        <dataField fieldName="CSY" hidden="true" />
        <dataField fieldName="SGID" columns="5" hidden="true" />
        <dataField fieldName="SCID" columns="5" hidden="true" />
        <dataField fieldName="extSGID" columns="15" />
        <dataField fieldName="extSCID" columns="15" />
        <dataField fieldName="Fullname" />
      </dataFields>
    </view>
    <view id="grid1_all_assessments" type="Grid" commandId="command1" label="All Assessment Scores" groupExpression=" Course, GradeLevel, Stream, Session" sortExpression="GLSO ASC" filter="SessionIsActive = 0">
      <headerText>$DefaultGridViewDescription</headerText>
      <dataFields>
        <dataField fieldName="Firstname" columns="18" />
        <dataField fieldName="Lastname" columns="18" />
        <dataField fieldName="UPN" columns="10" />
        <dataField fieldName="GradeLevel" columns="5" />
        <dataField fieldName="RefSchoolStreamID" aliasFieldName="Stream" columns="5" />
        <dataField fieldName="Course" columns="20" />
        <dataField fieldName="GradeBookEntryID" aliasFieldName="GradeBookTitle" columns="15" />
        <dataField fieldName="LetterGrade" columns="5" hidden="true" />
        <dataField fieldName="NumericGradeEarned" columns="5" />
        <dataField fieldName="extMaxScore" columns="5" />
        <dataField fieldName="Weight" columns="5" />
        <dataField fieldName="ExtPBSG" columns="5">
          <headerText>%PBSG</headerText>
        </dataField>
        <dataField fieldName="ExtPWS" columns="5">
          <headerText>PWS</headerText>
        </dataField>
        <dataField fieldName="ExtOWS" columns="5">
          <headerText>OWS</headerText>
        </dataField>
        <dataField fieldName="CWS" columns="5" />
        <dataField fieldName="StudentCourseSectionID" aliasFieldName="StudentCourseSectionCreatedBy" hidden="true" />
        <dataField fieldName="GradeBookEntryTypeID" aliasFieldName="GBEntryType" hidden="true" />
        <dataField fieldName="SubmittedDate" columns="10" hidden="true" />
        <dataField fieldName="PerformanceBaseConversionID" aliasFieldName="PerformanceBaseConversion" hidden="true" />
        <dataField fieldName="PerformanceBaseConversionDescription" hidden="true" />
        <dataField fieldName="MinScore" columns="15" hidden="true" />
        <dataField fieldName="MaxScore" columns="15" hidden="true" />
        <dataField fieldName="NG" columns="20" hidden="true" />
        <dataField fieldName="Passing" columns="5" />
        <dataField fieldName="ExtIsPassing" hidden="true" />
        <dataField fieldName="LG" columns="5" />
        <dataField fieldName="GradeRank" columns="15" hidden="true" />
        <dataField fieldName="CreatedDate" columns="20" hidden="true" />
        <dataField fieldName="ModifiedDate" columns="20" hidden="true" />
        <dataField fieldName="CreatedBy" columns="50" hidden="true" />
        <dataField fieldName="ModifiedBy" columns="50" hidden="true" />
        <dataField fieldName="UserID" columns="15" hidden="true" />
        <dataField fieldName="extIsActiveSession" columns="15" hidden="true" />
        <dataField fieldName="ASTY" columns="5" />
        <dataField fieldName="ExtIsCsy" columns="15" hidden="true" />
        <dataField fieldName="ExtActiveCourseSection" hidden="true" />
        <dataField fieldName="ExtCalendarSessionID" columns="15" hidden="true" />
        <dataField fieldName="GLSO" columns="15" hidden="true" />
        <dataField fieldName="GradingPeriodID" aliasFieldName="GradingPeriod" columns="12" />
        <dataField fieldName="SessionIsActive" />
        <dataField fieldName="Session" columns="50" hidden="true" />
        <dataField fieldName="calYear" columns="15" hidden="true" />
        <dataField fieldName="CSY" />
        <dataField fieldName="SGID" columns="5" />
        <dataField fieldName="SCID" columns="5" />
        <dataField fieldName="extSGID" columns="15" />
        <dataField fieldName="extSCID" columns="15" />
        <dataField fieldName="Fullname" />
      </dataFields>
    </view>
    <view id="export_assessment" type="Grid" commandId="command1" label="Export Assessment Scores" groupExpression=" Course, GradeLevel, Stream, Session" sortExpression="GLSO ASC" reportOrientation="Landscape" showInSelector="false">
      <headerText>$DefaultGridViewDescription</headerText>
      <dataFields>
        <dataField fieldName="Firstname" columns="18" />
        <dataField fieldName="Lastname" columns="18" />
        <dataField fieldName="UPN" columns="10" />
        <dataField fieldName="GradeLevel" columns="5" />
        <dataField fieldName="RefSchoolStreamID" aliasFieldName="Stream" columns="5" />
        <dataField fieldName="Course" columns="20" />
        <dataField fieldName="GradeBookEntryID" aliasFieldName="GradeBookTitle" columns="15" />
        <dataField fieldName="LetterGrade" columns="5" hidden="true" />
        <dataField fieldName="NumericGradeEarned" columns="5" />
        <dataField fieldName="extMaxScore" columns="5" />
        <dataField fieldName="Weight" columns="5" />
        <dataField fieldName="ExtPBSG" columns="5">
          <headerText>%PBSG</headerText>
        </dataField>
        <dataField fieldName="ExtPWS" columns="5">
          <headerText>PWS</headerText>
        </dataField>
        <dataField fieldName="ExtOWS" columns="5">
          <headerText>OWS</headerText>
        </dataField>
        <dataField fieldName="CWS" columns="5" />
        <dataField fieldName="StudentCourseSectionID" aliasFieldName="StudentCourseSectionCreatedBy" hidden="true" />
        <dataField fieldName="GradeBookEntryTypeID" aliasFieldName="GBEntryType" hidden="true" />
        <dataField fieldName="SubmittedDate" columns="10" hidden="true" />
        <dataField fieldName="PerformanceBaseConversionID" aliasFieldName="PerformanceBaseConversion" hidden="true" />
        <dataField fieldName="PerformanceBaseConversionDescription" hidden="true" />
        <dataField fieldName="MinScore" columns="15" hidden="true" />
        <dataField fieldName="MaxScore" columns="15" hidden="true" />
        <dataField fieldName="NG" columns="20" hidden="true" />
        <dataField fieldName="Passing" columns="5" />
        <dataField fieldName="ExtIsPassing" hidden="true" />
        <dataField fieldName="LG" columns="5" />
        <dataField fieldName="GradeRank" columns="15" hidden="true" />
        <dataField fieldName="CreatedDate" columns="20" hidden="true" />
        <dataField fieldName="ModifiedDate" columns="20" hidden="true" />
        <dataField fieldName="CreatedBy" columns="50" hidden="true" />
        <dataField fieldName="ModifiedBy" columns="50" hidden="true" />
        <dataField fieldName="UserID" columns="15" hidden="true" />
        <dataField fieldName="extIsActiveSession" columns="15" hidden="true" />
        <dataField fieldName="ASTY" columns="5" />
        <dataField fieldName="ExtIsCsy" columns="15" hidden="true" />
        <dataField fieldName="ExtActiveCourseSection" hidden="true" />
        <dataField fieldName="ExtCalendarSessionID" columns="15" hidden="true" />
        <dataField fieldName="GLSO" columns="15" hidden="true" />
        <dataField fieldName="GradingPeriodID" aliasFieldName="GradingPeriod" columns="12" />
        <dataField fieldName="SessionIsActive" />
        <dataField fieldName="Session" columns="50" hidden="true" />
        <dataField fieldName="calYear" columns="15" hidden="true" />
        <dataField fieldName="CSY" />
        <dataField fieldName="SGID" columns="5" />
        <dataField fieldName="SCID" columns="5" />
        <dataField fieldName="extSGID" columns="15" />
        <dataField fieldName="extSCID" columns="15" />
        <dataField fieldName="Fullname" />
      </dataFields>
    </view>
    <view id="editForm1" type="Form" commandId="command1" label="Review Assessment Score">
      <headerText>$DefaultEditViewDescription</headerText>
      <categories>
        <category id="c1" flow="NewColumn">
          <description />
          <dataFields>
            <dataField fieldName="Lastname" columns="35" />
            <dataField fieldName="Firstname" columns="35" />
            <dataField fieldName="UPN" columns="10" />
            <dataField fieldName="GradeBookEntryID" aliasFieldName="GradeBookTitle" />
            <dataField fieldName="GradeBookEntryTypeID" aliasFieldName="GBEntryType" />
            <dataField fieldName="ASTY" columns="50" hidden="true" />
            <dataField fieldName="SubmittedDate" columns="10" hidden="true" />
            <dataField fieldName="GradingPeriodID" aliasFieldName="GradingPeriod" />
            <dataField fieldName="Session" columns="50" />
            <dataField fieldName="extSGID" columns="15" />
            <dataField fieldName="extSCID" columns="15" />
            <dataField fieldName="Fullname" />
          </dataFields>
        </category>
        <category id="c2">
          <description />
          <dataFields>
            <dataField fieldName="NumericGradeEarned" columns="15" />
            <dataField fieldName="Weight" columns="15" />
            <dataField fieldName="extMaxScore" columns="15" />
            <dataField fieldName="ExtPBSG" columns="15" />
            <dataField fieldName="ExtPWS" columns="15" />
            <dataField fieldName="ExtOWS" columns="15" />
            <dataField fieldName="CWS" columns="15" hidden="true" />
            <dataField fieldName="NG" columns="20" />
            <dataField fieldName="LG" columns="20" />
            <dataField fieldName="LetterGrade" columns="5" hidden="true" />
            <dataField fieldName="ExtIsPassing" hidden="true" />
            <dataField fieldName="Passing" />
          </dataFields>
        </category>
        <category id="c4" flow="NewColumn">
          <description />
          <dataFields>
            <dataField fieldName="GradeLevel" />
            <dataField fieldName="RefSchoolStreamID" aliasFieldName="Stream" />
            <dataField fieldName="ExtActiveCourseSection" />
          </dataFields>
        </category>
        <category id="c5">
          <description />
          <dataFields>
            <dataField fieldName="SessionIsActive" />
            <dataField fieldName="extIsActiveSession" columns="15" hidden="true" />
            <dataField fieldName="Course" />
            <dataField fieldName="CSY" />
            <dataField fieldName="ExtIsCsy" columns="15" hidden="true" />
          </dataFields>
        </category>
        <category id="c3">
          <description />
          <dataFields>
            <dataField fieldName="PerformanceBaseConversionID" aliasFieldName="PerformanceBaseConversion" />
          </dataFields>
        </category>
        <category id="c6">
          <description />
          <dataFields>
            <dataField fieldName="ModifiedBy" columns="50" />
            <dataField fieldName="CreatedBy" columns="50" />
            <dataField fieldName="ModifiedDate" columns="20" />
            <dataField fieldName="CreatedDate" columns="20" />
            <dataField fieldName="UserID" columns="15" />
          </dataFields>
        </category>
      </categories>
    </view>
    <view id="createForm1" type="Form" commandId="command1" label="New Assessment Scores">
      <headerText>$DefaultCreateViewDescription</headerText>
      <categories>
        <category id="c1" flow="NewColumn">
          <description><![CDATA[$DefaultNewDescription]]></description>
          <dataFields>
            <dataField fieldName="LetterGrade" columns="5" />
            <dataField fieldName="NumericGradeEarned" columns="15" />
            <dataField fieldName="Weight" columns="15" />
            <dataField fieldName="StudentCourseSectionID" aliasFieldName="StudentCourseSectionCreatedBy" />
            <dataField fieldName="GradeBookEntryID" aliasFieldName="GradeBookTitle" />
            <dataField fieldName="GradeBookEntryTypeID" aliasFieldName="GBEntryType" />
            <dataField fieldName="ASTY" columns="50" />
            <dataField fieldName="GradingPeriodID" aliasFieldName="GradingPeriod" />
            <dataField fieldName="CompetencyLevelDescriptorID" columns="15" />
            <dataField fieldName="SubmittedDate" columns="10" />
            <dataField fieldName="PerformanceBaseConversionID" aliasFieldName="PerformanceBaseConversion" />
            <dataField fieldName="MinScore" columns="15" />
            <dataField fieldName="MaxScore" columns="15" />
            <dataField fieldName="NG" columns="20" />
            <dataField fieldName="LG" columns="20" />
            <dataField fieldName="Passing" />
            <dataField fieldName="PerformanceBaseConversionDescription" />
            <dataField fieldName="GradeRank" columns="15" />
            <dataField fieldName="CreatedDate" columns="20" />
            <dataField fieldName="ModifiedDate" columns="20" />
            <dataField fieldName="CreatedBy" columns="50" />
            <dataField fieldName="ModifiedBy" columns="50" />
            <dataField fieldName="UserID" columns="15" />
            <dataField fieldName="extMaxScore" columns="15" />
            <dataField fieldName="extIsActiveSession" columns="15" />
            <dataField fieldName="ExtIsCsy" columns="15" />
            <dataField fieldName="ExtActiveCourseSection" />
            <dataField fieldName="ExtPBSG" columns="15" />
            <dataField fieldName="ExtCalendarSessionID" columns="15" />
            <dataField fieldName="RefSchoolStreamID" aliasFieldName="Stream" />
            <dataField fieldName="ExtIsPassing" />
            <dataField fieldName="ExtPWS" columns="15" />
            <dataField fieldName="ExtOWS" columns="15" />
            <dataField fieldName="CWS" columns="15" />
            <dataField fieldName="GradeLevel" />
            <dataField fieldName="GLSO" columns="15" />
            <dataField fieldName="Session" columns="50" />
            <dataField fieldName="SessionIsActive" />
            <dataField fieldName="calYear" columns="15" />
            <dataField fieldName="CSY" />
            <dataField fieldName="UPN" columns="10" />
            <dataField fieldName="Firstname" columns="35" />
            <dataField fieldName="Lastname" columns="35" />
            <dataField fieldName="Course" />
            <dataField fieldName="SGID" columns="15" />
            <dataField fieldName="SCID" columns="15" />
            <dataField fieldName="extSGID" columns="15" />
            <dataField fieldName="extSCID" columns="15" />
            <dataField fieldName="Fullname" />
          </dataFields>
        </category>
      </categories>
    </view>
  </views>
  <actions>
    <actionGroup id="ag1" scope="Grid">
      <action id="a1" commandName="Select" commandArgument="editForm1" />
      <action id="a2" commandName="Edit" />
      <action id="a3" commandName="Delete" />
      <action id="a6" />
      <action id="a7" commandName="New" commandArgument="grid1" />
      <action id="a8" commandName="Duplicate" commandArgument="createForm1" />
      <action id="a9" />
      <action id="a10" commandName="BatchEdit" commandArgument="editForm1" />
    </actionGroup>
    <actionGroup id="ag2" scope="Form">
      <action id="a1" commandName="Edit" />
      <action id="a2" commandName="Delete" />
      <action id="a3" commandName="Cancel" />
      <action id="a4" whenLastCommandName="Edit" commandName="Update" commandArgument="Save" />
      <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
      <action id="a6" whenLastCommandName="New" commandName="Insert" commandArgument="Save" />
      <action id="a7" whenLastCommandName="New" commandName="Insert" commandArgument="SaveAndNew" />
      <action id="a8" whenLastCommandName="New" commandName="Cancel" />
      <action id="a9" whenLastCommandName="Duplicate" commandName="Insert" />
      <action id="a10" whenLastCommandName="Duplicate" commandName="Cancel" />
      <action id="a13" whenLastCommandName="Insert" whenLastCommandArgument="Save" whenView="createForm1" commandName="Select" commandArgument="editForm1" whenClientScript="this.hasDetails()" />
      <action id="a14" whenLastCommandName="Insert" whenLastCommandArgument="SaveAndNew" commandName="New" commandArgument="createForm1" />
    </actionGroup>
    <actionGroup id="ag3" scope="ActionBar" headerText="New" flat="true">
      <action id="a1" commandName="New" commandArgument="createForm1" cssClass="NewIcon" />
    </actionGroup>
    <actionGroup id="ag4" scope="ActionBar" headerText="Edit/Delete" flat="true">
      <action id="a1" whenKeySelected="true" commandName="Edit" commandArgument="editForm1" cssClass="EditIcon" whenView="grid1" />
      <action id="a2" whenKeySelected="true" commandName="Delete" cssClass="DeleteIcon" whenView="grid1" />
    </actionGroup>
    <actionGroup id="ag5" scope="ActionBar" headerText="Actions">
      <action commandName="SQL" headerText="Step 1: Build Repo" cssClass="material-icon-local_convenience_store" roles="Administrators, ContentEditors, ClassTeachers" id="a100">
        <data><![CDATA[/*
   11th Nov 2021
     First set the Calculated Partial Score and persist the value
     2nd Use the persisted ExtPBSG value to evaluate pass or fail for each assessment line item
*/

EXECUTE [dbo].[usp_merge_master_student_grades_gradebooks_p2]
SET @Result_Refresh = 1
SET @Result_ShowMessage = 'Partial scores calculation completed!!!' 


/*
30 October 2021
Desc : The script intends to build an aggregated history grades for students taking the current term into context.
Further modifications can be achieved via applying conditions / if statements make choices between Year, Term and CSY
*/
EXECUTE dbo.usp_merge_master_student_grades_gradebooks_p3
SET @Result_ShowMessage = 'Step 2 of Preparing aggregates grade records to completed!!!'
]]></data>
      </action>
      <action commandName="SQL" headerText="Step 2: Post Scores" description="Post and Sync Scores To AMT Repo" cssClass="material-icon-speaker_phone" confirmation="This action would synchronise current grades to the Analytical Middle Tier (AMT). Do you want to continue ?" roles="Administrators, ContentEditors" id="a101">
        <data><![CDATA[EXECUTE dbo.usp_merge_master_student_grades_gradebooks_p4
SET @Result_Refresh = 1
SET @Result_ShowMessage = 'Grades posting to central repo completed!!!' 

]]></data>
      </action>
      <action id="a2" />
      <action commandName="SQL" headerText="Step A: Post Photos" description="Post and Sync Scores To AMT Repo" cssClass="material-icon-auto-stories" confirmation="This action would synchronise current photos to the AMT. Do you want to continue ?" roles="Administrators, ContentEditors, ClassTeachers" id="a102">
        <data><![CDATA[--=======================================================
-- update photos and organisation logo
--=========================================================
update m
SET PhotoUrl = P.PhotoURL
FROM master_student_grades_gradebooks_p4 m
LEFT JOIN Person P ON P.PersonID = m.PersonID
WHERE m.PhotoUrl IS NULL
SET @Result_ShowMessage = 'updating student profile photos to central repo completed!!!' 

]]></data>
      </action>
      <action commandName="SQL" headerText="Step B: Update Logo" description="Post and Sync Scores To AMT Repo" cssClass="material-icon-image" confirmation="This action would update report with logo of the school to the AMT. Do you want to continue ?" roles="Administrators, ContentEditors, ClassTeachers" id="a103">
        <data><![CDATA[--=======================================================
-- update organisation logo
--=========================================================
update m
SET Logo = P.Logo
FROM master_student_grades_gradebooks_p4 m
INNER JOIN Organisation P ON P.OrganizationID = m.OrganizationID
WHERE m.Logo IS NULL
SET @Result_ShowMessage = 'Updating school logo for reporting completed!!!' 

]]></data>
      </action>
      <action id="a5" />
      <action commandName="SQL" headerText="Step Y: Reset Scoresheet" id="a108" description="Reset Current Attainment Scores" cssClass="material-icon-restart_alt" confirmation="This action resets the scoresheet in preparation for a new academic session. Reset the GBA Scoresheet to show only course sections in current session or term.&#xD;&#xA;Do you want to continue ?" roles="Administrators, ContentEditors">
        <data><![CDATA[-- Reset the StudentGradeBook to show only course sections in current Sessions

 EXEC  usp_ops_reset_scoresheet

SET @Result_ShowMessage = 'Student grade book entries records has been reset successfully.' ]]></data>
      </action>
      <action commandName="SQL" headerText="Step Z: Reset Base Reports" id="a109" description="Reset Current Attainment Scores" cssClass="material-icon-reset_tv" confirmation="This action reset scoresheet in preparation for a new academic session. All assessments scored for previous sessions would be archived. Do you want to continue ?" roles="Administrators, ContentEditors" notify="This action reset current session grades. Do you want to continue ?">
        <data><![CDATA[-- Reset the StudentGradeBook to show only course sections in current Sessions

EXEC   [dbo].[usp_ops_reset_master_student_grades_gradebooks_p4]

SET @Result_ShowMessage = 'Base Reporting has been reset successfully for current academic session.' ]]></data>
      </action>
      <action id="a104" />
      <action id="a107" />
      <action id="a6" commandName="Import" commandArgument="createForm1" />
      <action id="a7" commandName="DataSheet" />
      <action id="a8" commandName="Grid" />
    </actionGroup>
    <actionGroup id="ag6" scope="ActionBar" headerText="Record">
      <action id="a1" whenLastCommandName="Edit" commandName="Update" />
      <action id="a2" whenLastCommandName="Edit" commandName="Cancel" />
      <action id="a3" whenLastCommandName="New" commandName="Insert" />
      <action id="a4" whenLastCommandName="New" commandName="Cancel" />
    </actionGroup>
    <actionGroup id="ag7" scope="ActionBar" headerText="Report">
      <action id="a105" commandName="ReportAsPdf" headerText="Export To PDF" />
      <action id="a106" commandName="ReportAsExcel" headerText="Export To Excel" />
      <action id="a1" commandName="ExportCsv" headerText="Export To CSV" commandArgument="StudentGradeBookEntry, export_assessment" />
      <action id="a4" commandName="ReportAsWord" />
      <action id="a100" commandName="ExportRss" headerText="Send To RSS API" />
      <action id="a107" />
    </actionGroup>
    <actionGroup id="ag8" scope="Row">
      <action id="a4" whenLastCommandName="Edit" commandName="Update" />
      <action id="a5" whenLastCommandName="Edit" commandName="Cancel" />
      <action id="a6" whenLastCommandName="New" commandName="Insert" />
      <action id="a7" whenLastCommandName="New" commandName="Cancel" />
    </actionGroup>
  </actions>
  <businessRules>
    <rule id="r100" type="JavaScript" commandName="Insert|Update" phase="Before" name="validateNumericGradeEarned"><![CDATA[var fieldValue = [NumericGradeEarned];
if (fieldValue == null) {
    // prevent the default action processing
    this.preventDefault();
    // set the focus on the field and display an error
    this.result.focus('NumericGradeEarned', 'Required field.');
}]]></rule>
    <rule id="r102" type="JavaScript" commandName="Insert|Update" phase="Before" name="checkNumericGradeEarnedLimit"><![CDATA[var fieldValue = [NumericGradeEarned];
if (fieldValue != null && fieldValue > 100) {
    // prevent the default action processing
    this.preventDefault();
    // set the focus on the field and display an error
    this.result.focus('NumericGradeEarned', 'Score is greater than the threshold of 100.');
}]]></rule>
    <rule id="r101" commandName="Insert|Update|Calculate" type="Code" phase="Execute" name="setPBSGValue" />
    <rule id="r103" commandName="Insert|Update|Calculate" type="Code" phase="Execute" name="setOWSValue" />
  </businessRules>
</dataController>